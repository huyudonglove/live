webpackJsonp([13],{Zkxx:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("+63v"),i=r("y1lO"),s={name:"serverList",inject:["replace","reload"],components:{pagination:o.a},data:function(){return{serverTable:[],tableHeight:0,appIdList:[],showCreateServer:!1,form:{serverName:"",serverIP:"",positionCode:""},rules:{serverName:[{required:!0,message:"请输入服务器名称",trigger:"change"},{required:!0,message:"请输入服务器名称",trigger:"blur"}],serverIP:[{required:!0,message:"请输入服务器IP",trigger:"change"},{required:!0,message:"请输入服务器IP",trigger:"blur"}],positionCode:[{required:!0,message:"请输入地址编码",trigger:"change"},{required:!0,message:"请输入地址编码",trigger:"blur"}]},isConfirm:!1,editId:"",totalNum:0}},watch:{$route:function(){"serverList"==this.$route.name&&this.listData()}},methods:{handleSelectionChange:function(e){this.appIdList=e.map(function(e){return e.id})},closeDialog:function(){this.form.serverName="",this.form.serverIP="",this.form.positionCode="",this.editId=""},editDialog:function(e){this.showCreateServer=!0,this.editId=e.id,this.form.serverName=e.name,this.form.serverIP=e.address,this.form.positionCode=e.positionCode},createServer:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return console.log("error submit!!"),!1;e.editId?e.$confirm("确认编辑吗？").then(function(){e.isConfirm=!0,Object(i.q)({id:e.editId,name:e.form.serverName,address:e.form.serverIP,positionCode:e.form.positionCode}).then(function(t){e.isConfirm=!1,t.code?e.$message.error(t.msg):(e.$message.success(t.msg),e.showCreateServer=!1,e.reload())}).catch(function(t){e.isConfirm=!1})}):e.$confirm("确认新建吗？").then(function(){e.isConfirm=!0,Object(i.d)({name:e.form.serverName,address:e.form.serverIP,positionCode:e.form.positionCode}).then(function(t){e.isConfirm=!1,t.code?e.$message.error(t.msg):(e.$message.success(t.msg),e.showCreateServer=!1,e.reload())}).catch(function(t){e.isConfirm=!1})})})},listData:function(){var e=this;Object(i.H)(this.$route.query).then(function(t){e.serverTable=t.data.items,e.totalNum=t.data.total})}},created:function(){this.listData()},updated:function(){var e=this;"serverList"==this.$route.name&&this.$nextTick(function(){e.tableHeight=window.innerHeight-e.$refs.userRef.$el.offsetTop-110})}},a={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticStyle:{height:"50px","border-bottom":"1px solid #DFDCDC"}},[r("span",{staticStyle:{"font-size":"24px","font-weight":"bold",color:"#614a4d"}},[e._v("服务器管理")]),e._v(" "),r("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(t){e.showCreateServer=!0}}},[e._v("新建")])],1),e._v(" "),r("el-table",{ref:"userRef",staticClass:"mt15 mb15",staticStyle:{width:"100%"},attrs:{data:e.serverTable,border:"","max-height":e.tableHeight,"row-key":"id"},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"50","reserve-selection":!0}}),e._v(" "),r("el-table-column",{attrs:{prop:"id",label:"ID",width:"100",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"name",label:"服务器名称",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"address",label:"服务器IP",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"positionCode",label:"地址编码",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"createBy",label:"创建人",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"createTime",label:"创建时间",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"status",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?r("span",{staticStyle:{color:"339900"}},[e._v("在线")]):e._e(),e._v(" "),2==t.row.status?r("span",{staticStyle:{color:"ff9900"}},[e._v("离线")]):e._e()]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作",fixed:"right",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){return e.editDialog(t.row)}}},[e._v("编辑")])]}}])})],1),e._v(" "),r("div",[r("pagination",{attrs:{totalNum:e.totalNum}})],1),e._v(" "),r("el-dialog",{attrs:{title:(e.editId?"编辑":"创建")+"服务器",visible:e.showCreateServer,"destroy-on-close":"",width:"550px",center:""},on:{"update:visible":function(t){e.showCreateServer=t},close:e.closeDialog}},[r("el-form",{ref:"form",attrs:{"label-width":"120px",model:e.form,rules:e.rules}},[r("el-form-item",{attrs:{label:"服务器名称：",prop:"serverName",required:""}},[r("el-input",{staticStyle:{width:"200px"},attrs:{maxlength:"20"},model:{value:e.form.serverName,callback:function(t){e.$set(e.form,"serverName","string"==typeof t?t.trim():t)},expression:"form.serverName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"服务器IP：",prop:"serverIP",required:""}},[r("el-input",{staticStyle:{width:"200px"},attrs:{maxlength:"20"},model:{value:e.form.serverIP,callback:function(t){e.$set(e.form,"serverIP",t)},expression:"form.serverIP"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"地址编码：",prop:"positionCode",required:""}},[r("el-input",{staticStyle:{width:"200px"},attrs:{maxlength:"20"},model:{value:e.form.positionCode,callback:function(t){e.$set(e.form,"positionCode",t)},expression:"form.positionCode"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{disabled:e.isConfirm,type:"primary"},on:{click:e.createServer}},[e._v(e._s(e.isConfirm&&e.editId?"编辑中...":e.isConfirm&&!e.editId?"新建中...":"确 定"))]),e._v(" "),r("el-button",{on:{click:function(t){e.showCreateServer=!1}}},[e._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var n=r("VU/8")(s,a,!1,function(e){r("eaPv")},"data-v-55e6501e",null);t.default=n.exports},eaPv:function(e,t){}});