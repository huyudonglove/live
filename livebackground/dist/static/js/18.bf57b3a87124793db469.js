webpackJsonp([18],{igmi:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("Dd8w"),a=i.n(n),l=i("+63v"),s=i("y1lO"),o=i("xrTZ"),r={name:"channelInfo",inject:["replace","reload"],components:{pagination:l.a},data:function(){return{inputX:"",status:"",liveTable:[],appIdList:[],channelInfo:{},totalNum:0,sortName:"",sortType:""}},watch:{inputX:function(){this.replace("liveName",this.inputX),this.appIdList=[]},status:function(){this.replace("isOnShelf",this.status),this.appIdList=[]},sortType:function(){this.replace("sortType",this.sortType),this.appIdList=[]},sortName:function(){this.replace("sortName",this.sortName),this.appIdList=[]},$route:function(){"channelInfo"==this.$route.name&&this.listData()}},methods:{sortChange:function(t){this.sortName=t.prop.replace(/[A-Z]/g,function(t,e){return"_"+t.toLowerCase()}),this.sortType="ascending"==t.order?"asc":"desc",this.listData()},handleSelectionChange:function(t){this.appIdList=t.map(function(t){return t.id})},up:function(t,e,i){var n=this;1==t?this.$confirm("确认上架吗？").then(function(t){Object(s.Q)({ids:[e],isBatch:!1}).then(function(t){t.code?(n.$message.error(t.msg),n.liveTable.forEach(function(t){t.id==e&&(t.isOnShelf=2)})):n.$message.success("上架成功")}).catch(function(t){n.liveTable.forEach(function(t){t.id==e&&(t.isOnShelf=2)})})}).catch(function(t){n.liveTable.forEach(function(t){t.id==e&&(t.isOnShelf=2)})}):2==t&&this.$confirm("确认下架吗？").then(function(t){Object(s.P)({ids:[e],isBatch:!1}).then(function(t){t.code?(n.$message.error(t.msg),n.liveTable.forEach(function(t){t.id==e&&(t.isOnShelf=1)})):n.$message.success("下架成功")}).catch(function(t){n.liveTable.forEach(function(t){t.id==e&&(t.isOnShelf=1)})})}).catch(function(t){n.liveTable.forEach(function(t){t.id==e&&(t.isOnShelf=1)})})},lotUp:function(){var t=this;if(this.appIdList.length){var e=this.appIdList.filter(function(e){return t.liveTable.some(function(t){return t.id==e&&(1==t.liveState||2==t.liveState)})});if(e.length)return void this.$alert("所选id为"+e.join("、")+" 的直播间存在直播中或回放中，不允许上架",{dangerouslyUseHTMLString:!0});Object(s.Q)({ids:this.appIdList,isBatch:!0}).then(function(e){t.reload()})}else this.$message.error("请勾选需要上架的行")},lotLower:function(){var t=this;if(this.appIdList.length){var e=this.appIdList.filter(function(e){return t.liveTable.some(function(t){return t.id==e&&(1==t.liveState||2==t.liveState)})});if(e.length)return void this.$alert("所选id为"+e.join("、")+" 的直播间存在直播中或回放中，不允许下架",{dangerouslyUseHTMLString:!0});Object(s.P)({ids:this.appIdList,isBatch:!0}).then(function(e){t.reload()})}else this.$message.error("请勾选需要下架的行")},del:function(t){var e=this;Object(s.O)([t]).then(function(t){1===e.liveTable.length&&e.replace("page",1),e.reload()})},getInfo:function(){var t=this;Object(s.x)({id:this.$route.query.id}).then(function(e){e.code?t.$message.error(e.msg):(t.channelInfo=e.data,t.channelInfo.imgUrl=e.data.channelCover?o.Base64.decode(e.data.channelCover):"")})},playVideo:function(t,e,i){var n=this,a=this.$router.resolve({name:"aliplayer"});Object(s.M)({id:t}).then(function(l){var s=l.data.cameraList?l.data.cameraList:[];if(s.length&&1==e){var o=1==e&&1==i?l.data.cameraList[0].deviceDto.address:"",r=1==e&&1==i?l.data.cameraList[0].deviceDto.token:"";window.open(a.href+"?rtmpUrl="+o+"&token="+r+"&id="+t+"&liveState="+e+"&state="+i+"&first=1","win1","height=800,width=1000,toolbar =no, menubar=yes, scrollbars=no, resizable=no, location=no, status=no")}else if(s.length||1!=e)if(l.data){window.open(a.href+"?rtmpUrl=&id="+t+"&liveState="+e+"&state="+i+"&first=1","win1","height=800,width=1000,toolbar =no, menubar=yes, scrollbars=no, resizable=no, location=no, status=no")}else n.$message.error("没有播放地址");else{window.open(a.href+"?rtmpUrl=&id="+t+"&liveState=-1&state="+i+"&first=1","win1","height=800,width=1000,toolbar =no, menubar=yes, scrollbars=no, resizable=no, location=no, status=no")}})},listData:function(){var t=this;Object(s.C)(a()({channelId:this.$route.query.id},this.$route.query)).then(function(e){t.liveTable=e.data.items.map(function(t){return t.liveCover&&(t.imgUrl=o.Base64.decode(t.liveCover)),t}),t.totalNum=e.data.total})}},created:function(){this.getInfo(),this.listData(),this.inputX=this.$route.query.liveName||"",this.status=this.$route.query.isOnShelf||""}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",["channelInfo"==t.$route.name?i("div",[i("div",{staticStyle:{height:"50px","border-bottom":"1px solid #DFDCDC","margin-bottom":"10px"}},[i("el-page-header",{staticStyle:{"font-size":"24px","font-weight":"bold",color:"#614a4d"},attrs:{content:"频道详情"},on:{back:function(e){t.$router.push({path:"/channelList",query:JSON.parse(t.$route.query.oldQuery)})}}})],1),t._v(" "),i("div",{staticStyle:{overflow:"hidden",color:"#606266"}},[i("div",{staticStyle:{width:"300px",height:"306px",float:"left"}},[i("el-image",{staticStyle:{width:"300px",height:"300px",border:"3px solid #DCDFE6"},attrs:{src:t.channelInfo.imgUrl?"/static/"+t.channelInfo.imgUrl:""}})],1),t._v(" "),i("div",{staticStyle:{float:"left","margin-left":"50px"}},[i("div",{staticStyle:{"line-height":"70px"}},[i("div",{staticStyle:{display:"inline-block",width:"800px"}},[i("h2",{staticStyle:{display:"inline"}},[t._v(t._s(t.channelInfo.channelName))]),t._v(" "),i("h3",{staticStyle:{display:"inline","margin-left":"150px"}},[t._v(t._s(t.channelInfo.channelViceTopic))])])]),t._v(" "),i("div",{staticStyle:{"line-height":"60px","font-size":"18px","font-weight":"bold"}},[i("span",[t._v("发布用户：")]),i("span",{staticClass:"myDetails",staticStyle:{width:"210px"}},[t._v(t._s(t.channelInfo.author))]),t._v(" "),i("span",[t._v("类别：")]),i("span",{staticClass:"myDetails",staticStyle:{width:"250px"}},[t._v(t._s("全部"))]),t._v(" "),i("span",[t._v("状态：")]),i("span",{staticClass:"myDetails",style:{color:1==t.channelInfo.state?"#0000ff":2==t.channelInfo.state?"#008000":""}},[t._v(t._s(1==t.channelInfo.state?"已上架":2==t.channelInfo.state?"已下架":""))])]),t._v(" "),i("div",{staticStyle:{"line-height":"60px","font-size":"18px","font-weight":"bold","margin-bottom":"20px"}},[i("span",[t._v("发布时间：")]),i("span",{staticClass:"myDetails",staticStyle:{width:"210px"}},[t._v(t._s(t.channelInfo.createTime))]),t._v(" "),i("span",[t._v("最新修改时间：")]),i("span",{staticClass:"myDetails",staticStyle:{width:"210px"}},[t._v(t._s(t.channelInfo.updateTime))]),t._v(" "),i("span",[t._v("直播间数量：")]),i("span",{staticClass:"myDetails",staticStyle:{width:"100px"}},[t._v(t._s(t.channelInfo.liveNum))]),t._v(" "),i("span",[t._v("在线观看人数：")]),i("span",{staticClass:"myDetails",staticStyle:{width:"100px"}},[t._v(t._s(t.channelInfo.onlineViewing))])]),t._v(" "),i("div",{staticStyle:{"font-size":"18px","font-weight":"bold"}},[i("span",{staticStyle:{"vertical-align":"top"}},[t._v("简介：")]),t._v(" "),i("span",{staticStyle:{display:"inline-block",width:"1000px",height:"80px",border:"1px solid #DCDFE6","overflow-y":"auto","font-weight":"500"}},[t._v(t._s(t.channelInfo.channelBrief))])])])]),t._v(" "),i("el-row",{staticClass:"tac",staticStyle:{"border-bottom":"1px solid #eeeeee",padding:"15px 0"}},[i("el-input",{staticStyle:{width:"250px"},attrs:{"suffix-icon":"el-icon-search",maxlength:"50",placeholder:"请输入直播标题"},on:{change:function(e){return t.replace("page",1)}},model:{value:t.inputX,callback:function(e){t.inputX=e},expression:"inputX"}}),t._v(" "),i("span",{staticClass:"myWords"},[t._v("\n        状态\n        "),i("el-select",{staticStyle:{width:"150px"},on:{change:function(e){return t.replace("page",1)}},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[i("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),i("el-option",{attrs:{label:"已上架",value:1}}),t._v(" "),i("el-option",{attrs:{label:"已下架",value:2}})],1)],1),t._v(" "),i("el-button",{attrs:{type:"success",size:"mini"},on:{click:t.lotUp}},[t._v("批量上架")]),t._v(" "),i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:t.lotLower}},[t._v("批量下架")]),t._v(" "),t.appIdList.length?i("span",{staticStyle:{color:"#606266"}},[i("i",{staticClass:"el-icon-warning"}),t._v("已选择"),i("span",{staticStyle:{color:"#409EFF"}},[t._v(t._s(t.appIdList.length))]),t._v("项数据")]):t._e()],1),t._v(" "),i("el-table",{ref:"liveRef",staticClass:"mt15 mb15",staticStyle:{width:"100%","margin-bottom":"32px"},attrs:{data:t.liveTable,border:"","row-key":"id"},on:{"sort-change":t.sortChange,"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"50","reserve-selection":!0}}),t._v(" "),i("el-table-column",{attrs:{prop:"id",label:"ID",width:"50",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"imgUrl",label:"直播封面图",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(t){return[i("img",{directives:[{name:"focus",rawName:"v-focus"}],staticStyle:{width:"70px",height:"70px"},attrs:{src:t.row.imgUrl?"/static/"+t.row.imgUrl:"",alt:""}})]}}],null,!1,2592273075)}),t._v(" "),i("el-table-column",{attrs:{prop:"liveName",label:"直播标题",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical"}},[t._v(t._s(e.row.liveName))])]}}],null,!1,1106160070)}),t._v(" "),i("el-table-column",{attrs:{prop:"liveViceTopic",label:"直播副标题",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical"}},[t._v(t._s(e.row.liveViceTopic))])]}}],null,!1,4252396057)}),t._v(" "),i("el-table-column",{attrs:{prop:"liveClassify",label:"直播类别",width:"120",align:"center"}},[t._v("\n        "+t._s("全部")+"\n      ")]),t._v(" "),i("el-table-column",{attrs:{prop:"author",label:"发布用户",width:"150",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"createTime",label:"发布时间",width:"180",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"liveBrief",label:"直播简介",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical"}},[t._v(t._s(e.row.liveBrief))])]}}],null,!1,3886963483)}),t._v(" "),i("el-table-column",{attrs:{prop:"liveState",label:"直播状态",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.liveState?i("span",[t._v("未开播")]):t._e(),t._v(" "),1==e.row.liveState?i("span",[t._v("直播中")]):t._e(),t._v(" "),2==e.row.liveState?i("span",[t._v("回放中")]):t._e(),t._v(" "),3==e.row.liveState?i("span",[t._v("已结束")]):t._e()]}}],null,!1,492117936)}),t._v(" "),i("el-table-column",{attrs:{prop:"isNeedPassword",label:"直播间密码",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.isNeedPassword?i("span",[t._v("有")]):t._e(),t._v(" "),1==e.row.isNeedPassword?i("span",[t._v("无")]):t._e()]}}],null,!1,287278040)}),t._v(" "),i("el-table-column",{attrs:{prop:"liveNetRule",label:"网络规则",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.liveNetRule?i("span",[t._v("内网")]):t._e(),t._v(" "),1==e.row.liveNetRule?i("span",[t._v("公网")]):t._e()]}}],null,!1,3309578072)}),t._v(" "),i("el-table-column",{attrs:{prop:"createTime",label:"直播间创建时间",width:"150",align:"center",sortable:""}}),t._v(" "),i("el-table-column",{attrs:{prop:"lastLiveTime",label:"上次直播时间",width:"150",align:"center",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.lastLiveTime?e.row.lastLiveTime:"--")+"\n        ")]}}],null,!1,2573350712)}),t._v(" "),i("el-table-column",{attrs:{prop:"duration",label:"直播总时长",width:"120",align:"center",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.duration?parseInt(e.row.duration/3600).toString().padStart(2,"0")+":"+parseInt(e.row.duration%3600/60).toString().padStart(2,"0")+":"+Math.ceil(e.row.duration%60).toString().padStart(2,"0"):"0:00"))])]}}],null,!1,2299026337)}),t._v(" "),i("el-table-column",{attrs:{prop:"onlineViewing",label:"在线观看人数",width:"130",align:"center",sortable:""}}),t._v(" "),i("el-table-column",{attrs:{prop:"isOnShelf",label:"上架状态",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-switch",{attrs:{"active-value":1,"inactive-value":2,disabled:1==e.row.liveState||2==e.row.liveState},on:{change:function(i){return t.up(e.row.isOnShelf,e.row.id)}},model:{value:e.row.isOnShelf,callback:function(i){t.$set(e.row,"isOnShelf",i)},expression:"scope.row.isOnShelf"}})]}}],null,!1,2395982815)}),t._v(" "),i("el-table-column",{attrs:{label:"操作",fixed:"right",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(i){return t.playVideo(e.row.id,e.row.liveState,e.row.isOnShelf)}}},[t._v("预览")]),t._v(" "),i("el-button",{attrs:{disabled:2!=e.row.isOnShelf,type:"danger",size:"mini"},on:{click:function(i){return t.del(e.row.id)}}},[t._v("删除")])]}}],null,!1,4201095928)})],1),t._v(" "),i("div",[i("pagination",{attrs:{totalNum:t.totalNum}})],1)],1):t._e(),t._v(" "),i("div",[i("router-view")],1)])},staticRenderFns:[]};var u=i("VU/8")(r,c,!1,function(t){i("yeHv")},"data-v-2d1aeb92",null);e.default=u.exports},yeHv:function(t,e){}});