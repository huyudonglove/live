webpackJsonp([7],{"O/yy":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("Dd8w"),n=i.n(a),l=i("NYxO"),s=i("+63v"),o=i("y1lO"),r=i("xrTZ"),c={name:"livingList",inject:["replace","reload"],components:{pagination:s.a},data:function(){return{inputX:"",status:"",roomStatus:"",classBy:"",tableData:[],tableHeight:0,multipleSelection:[],appIdList:[],orderByName:"",orderBy:"",total:0,loading:null}},computed:n()({},Object(l.b)("pagination",{page:"clickPage",limit:"limitPage"})),watch:{page:function(){this.replace("page",this.page)},limit:function(){this.replace("limit",this.limit)},inputX:function(){this.replace("liveName",this.inputX),this.appIdList=[]},status:function(){this.replace("state",this.status),this.appIdList=[]},roomStatus:function(){this.replace("roomStatus",this.roomStatus),this.appIdList=[]},classBy:function(){this.replace("liveClassify",this.classBy),this.appIdList=[]},orderBy:function(){this.replace("orderBy",this.orderBy),this.appIdList=[]},orderByName:function(){this.replace("orderByName",this.orderByName),this.appIdList=[]},$route:function(){"livingList"==this.$route.name&&this.listData()}},methods:{up:function(t,e){var i=this;1==t?this.$confirm("确认上架吗？").then(function(t){Object(o.T)({ids:[e],isBatch:!1}).then(function(t){t.code?(i.$message.error(t.msg),i.tableData.forEach(function(t){t.id==e&&(t.isOnShelf=2)})):i.$message.success("上架成功")}).catch(function(t){i.tableData.forEach(function(t){t.id==e&&(t.isOnShelf=2)})})}).catch(function(t){i.tableData.forEach(function(t){t.id==e&&(t.isOnShelf=2)})}):2==t&&this.$confirm("确认下架吗？").then(function(t){Object(o.S)({ids:[e],isBatch:!1}).then(function(t){t.code?(i.$message.error(t.msg),i.tableData.forEach(function(t){t.id==e&&(t.isOnShelf=1)})):i.$message.success("下架成功")}).catch(function(t){i.tableData.forEach(function(t){t.id==e&&(t.isOnShelf=1)})})}).catch(function(t){i.tableData.forEach(function(t){t.id==e&&(t.isOnShelf=1)})})},lotUp:function(){var t=this,e=this.appIdList.map(function(t){return t.id});if(this.appIdList.length){var i;i=this.appIdList.filter(function(t){return 2!==t.liveState&&1!==t.liveState}),this.appIdList.length!==i.length?this.$message.error("直播中、回访中的直播间不允许进行上下架"):Object(o.T)({ids:e,isBatch:!0}).then(function(e){t.reload()})}else this.$message.error("请勾选需要上架的行")},lotLower:function(){var t=this,e=this.appIdList.map(function(t){return t.id});if(this.appIdList.length){var i;i=this.appIdList.filter(function(t){return 2!==t.liveState&&1!==t.liveState}),this.appIdList.length!=i.length?this.$message.error("直播中、回放中的直播间不允许进行上下架"):Object(o.S)({ids:e,isBatch:!0}).then(function(e){t.reload()})}else this.$message.error("请勾选需要下架的行")},lotDel:function(t){var e,i=this,a=this.appIdList.map(function(t){return t.id});e=this.appIdList.filter(function(t){return 2==t.isOnShelf}),"all"==t&&this.appIdList.length?this.appIdList.length!==e.length?this.$message.error("只有下架中的才可以被删除"):Object(o.R)({ids:a,isBatch:!0}).then(function(t){i.reload()}):"all"!=t||this.appIdList.length?Object(o.R)({ids:[t],isBatch:!0}).then(function(t){i.reload()}):this.$message.error("请勾选需要删除的行")},listData:function(){var t=this;this.loading=this.$loading({lock:!0,text:"数据获取中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),Object(o.U)(this.$route.query).then(function(e){t.loading.close(),t.tableData=e.data.items.map(function(t){return t.liveCover&&(t.liveCover=r.Base64.decode(t.liveCover)),t}),t.total=e.data.total}).catch(function(e){t.loading.close()})},handleSelectionChange:function(t){this.multipleSelection=t,this.appIdList=this.multipleSelection},changeUpadte:function(t){this.orderByName=t.prop.replace(/[A-Z]/g,function(t,e){return"_"+t.toLowerCase()}),this.orderBy="ascending"==t.order?"asc":"descending"==t.order?"desc":""},openWin:function(t,e,i){var a=this,n=(window.screen.height,this.$router.resolve({name:"aliplayer"}));Object(o.M)({id:t}).then(function(l){var s=l.data.cameraList?l.data.cameraList:[];if(s.length&&1==e){var o=1==e&&1==i?l.data.cameraList[0].deviceDto.address:"",r=1==e&&1==i?l.data.cameraList[0].deviceDto.token:"";window.open(n.href+"?rtmpUrl="+o+"&token="+r+"&id="+t+"&liveState="+e+"&state="+i+"&first=1","win1","height=800,width=1000,toolbar =no, menubar=yes, scrollbars=no, resizable=no, location=no, status=no,left=0,top=0")}else if(s.length||1!=e)if(l.data){window.open(n.href+"?rtmpUrl=&id="+t+"&liveState="+e+"&state="+i+"&first=1","win1","height=800,width=1000,toolbar =no, menubar=yes, scrollbars=no, resizable=no, location=no, status=no")}else a.$message.error("没有播放地址");else{window.open(n.href+"?rtmpUrl=&id="+t+"&liveState=-1&state="+i+"&first=1","win1","height=800,width=1000,toolbar =no, menubar=yes, scrollbars=no, resizable=no, location=no, status=no")}})}},created:function(){this.listData();this.$route.query.page,this.$route.query.limit;this.inputX=this.$route.query.liveName||"",this.status=this.$route.query.state||"",this.roomStatus=this.$route.query.roomStatus||"",this.classBy=this.$route.query.liveClassify||""},updated:function(){var t=this;"livingList"==this.$route.name&&this.$nextTick(function(){t.tableHeight=window.innerHeight-t.$refs.userRef.$el.offsetTop-110})}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",["livingList"==t.$route.name?i("div",[t._m(0),t._v(" "),i("el-row",{staticClass:"tac",staticStyle:{"border-bottom":"1px solid #eeeeee",padding:"15px 0"}},[i("span",{staticClass:"myWords"},[t._v("\n        标题：\n        "),i("el-input",{staticStyle:{width:"250px"},attrs:{"suffix-icon":"el-icon-search",maxlength:"50",placeholder:"请输入标题搜索"},on:{change:function(e){return t.replace("page",1)}},model:{value:t.inputX,callback:function(e){t.inputX=e},expression:"inputX"}})],1),t._v(" "),i("span",{staticClass:"myWords"},[t._v("\n        类别：\n        "),i("el-select",{staticStyle:{width:"150px"},on:{change:function(e){return t.replace("page",1)}},model:{value:t.classBy,callback:function(e){t.classBy=e},expression:"classBy"}},[i("el-option",{attrs:{label:"全部",value:""}})],1)],1),t._v(" "),i("span",{staticClass:"myWords"},[t._v("\n        直播状态：\n        "),i("el-select",{staticStyle:{width:"150px"},on:{change:function(e){return t.replace("page",1)}},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[i("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),i("el-option",{attrs:{label:"直播中",value:"1"}}),t._v(" "),i("el-option",{attrs:{label:"未开播",value:"0"}}),t._v(" "),i("el-option",{attrs:{label:"已结束",value:"3"}}),t._v(" "),i("el-option",{attrs:{label:"回放中",value:"2"}})],1)],1),t._v(" "),i("span",{staticClass:"myWords"},[t._v("\n        直播间状态：\n        "),i("el-select",{staticStyle:{width:"150px"},on:{change:function(e){return t.replace("page",1)}},model:{value:t.roomStatus,callback:function(e){t.roomStatus=e},expression:"roomStatus"}},[i("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),i("el-option",{attrs:{label:"已上架",value:"1"}}),t._v(" "),i("el-option",{attrs:{label:"已下架",value:"2"}})],1)],1),t._v(" "),i("el-button",{attrs:{type:"success",size:"mini"},on:{click:t.lotUp}},[t._v("批量上架")]),t._v(" "),i("el-button",{attrs:{type:"warning",size:"mini"},on:{click:t.lotLower}},[t._v("批量下架")]),t._v(" "),i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.lotDel("all")}}},[t._v("批量删除")]),t._v(" "),t.appIdList.length?i("span",{staticStyle:{color:"#606266"}},[i("i",{staticClass:"el-icon-warning"}),t._v("已选择"),i("span",{staticStyle:{color:"#409EFF"}},[t._v(t._s(t.appIdList.length))]),t._v("条")]):t._e()],1),t._v(" "),i("el-table",{ref:"userRef",staticClass:"mt15 mb15",staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"","max-height":t.tableHeight,"row-key":"id"},on:{"selection-change":t.handleSelectionChange,"sort-change":t.changeUpadte}},[i("el-table-column",{attrs:{type:"selection",width:"50","reserve-selection":!0,align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"id",label:"ID",width:"50",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"liveCover",label:"直播封面图",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(t){return[i("img",{directives:[{name:"focus",rawName:"v-focus"}],staticStyle:{width:"70px",height:"70px"},attrs:{src:t.row.liveCover?"/static/"+t.row.liveCover:"",alt:""}})]}}],null,!1,2989880595)}),t._v(" "),i("el-table-column",{attrs:{prop:"liveName",label:"直播标题",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical"}},[t._v(t._s(e.row.liveName))])]}}],null,!1,1106160070)}),t._v(" "),i("el-table-column",{attrs:{prop:"liveViceTopic",label:"直播副标题",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical"}},[t._v(t._s(e.row.liveViceTopic))])]}}],null,!1,4252396057)}),t._v(" "),i("el-table-column",{attrs:{prop:"liveClassify",label:"直播类别",width:"120",align:"center"}},[t._v("\n        "+t._s("全部")+"\n      ")]),t._v(" "),i("el-table-column",{attrs:{prop:"author",label:"直播用户",width:"120",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"liveBrief",label:"直播简介",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical"}},[t._v(t._s(e.row.liveBrief))])]}}],null,!1,3886963483)}),t._v(" "),i("el-table-column",{attrs:{prop:"liveState",label:"直播状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.liveState?i("span",[t._v("未开播")]):t._e(),t._v(" "),1==e.row.liveState?i("span",[t._v("直播中")]):t._e(),t._v(" "),2==e.row.liveState?i("span",[t._v("回放中")]):t._e(),t._v(" "),3==e.row.liveState?i("span",[t._v("已结束")]):t._e()]}}],null,!1,492117936)}),t._v(" "),i("el-table-column",{attrs:{prop:"isNeedPassword",label:"直播间密码",align:"center",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.isNeedPassword?i("span",[t._v("有")]):t._e(),t._v(" "),1==e.row.isNeedPassword?i("span",[t._v("无")]):t._e()]}}],null,!1,287278040)}),t._v(" "),i("el-table-column",{attrs:{prop:"liveNetRule",label:"网络规则",align:"center",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.liveNetRule?i("span",[t._v("内网")]):t._e(),t._v(" "),1==e.row.liveNetRule?i("span",[t._v("公网")]):t._e()]}}],null,!1,3309578072)}),t._v(" "),i("el-table-column",{attrs:{prop:"createTime",label:"直播间创建时间",width:"110",align:"center",sortable:"custom"}}),t._v(" "),i("el-table-column",{attrs:{prop:"lastLiveTime",label:"上次直播时间",width:"110",align:"center",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n           "+t._s(e.row.lastLiveTime?e.row.lastLiveTime:"--")+"\n          ")]}}],null,!1,2693279032)}),t._v(" "),i("el-table-column",{attrs:{prop:"duration",label:"直播总时长",width:"90",align:"center",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.duration?parseInt(e.row.duration/3600).toString().padStart(2,"0")+":"+parseInt(e.row.duration%3600/60).toString().padStart(2,"0")+":"+Math.ceil(e.row.duration%60).toString().padStart(2,"0"):"0:00")+"\n          ")]}}],null,!1,2817863610)}),t._v(" "),i("el-table-column",{attrs:{prop:"onlineViewing",label:"在线观看人数",width:"100",align:"center",sortable:"custom"}}),t._v(" "),i("el-table-column",{attrs:{prop:"isOnShelf",label:"上架状态",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-switch",{attrs:{disabled:1==e.row.liveState||2==e.row.liveState,"active-value":1,"inactive-value":2},on:{change:function(i){return t.up(e.row.isOnShelf,e.row.id)}},model:{value:e.row.isOnShelf,callback:function(i){t.$set(e.row,"isOnShelf",i)},expression:"scope.row.isOnShelf"}})]}}],null,!1,818003615)}),t._v(" "),i("el-table-column",{attrs:{label:"操作",fixed:"right",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){return t.openWin(e.row.id,e.row.liveState,e.row.isOnShelf)}}},[t._v("预览")]),t._v(" "),2==e.row.isOnShelf?i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return t.lotDel(e.row.id)}}},[t._v("删除")]):t._e()]}}],null,!1,4286197533)})],1),t._v(" "),i("div",[i("pagination",{attrs:{totalNum:t.total}})],1)],1):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{height:"50px","border-bottom":"1px solid #DFDCDC","margin-bottom":"10px"}},[e("span",{staticStyle:{"font-size":"24px","font-weight":"bold",color:"#614a4d"}},[this._v("直播页面管理")])])}]};var p=i("VU/8")(c,u,!1,function(t){i("X1ka")},"data-v-a46765e6",null);e.default=p.exports},X1ka:function(t,e){}});