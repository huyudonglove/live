{"version":3,"sources":["webpack:///src/components/position/positionList.vue","webpack:///./src/components/position/positionList.vue?28ba","webpack:///./src/components/position/positionList.vue"],"names":["positionList","name","inject","components","pagination","data","isConfirm","isEdit","treedata","defaultProps","label","isLeaf","positionTable","showAssetsDialog","firstLevel","clickInfo","clickNode","editId","form","positionName","parentPositionName","parentId","rules","required","message","trigger","tableHeight","treeHeight","totalNum","myNode0","myResolve0","nodeObject","isEditRow","watch","$route","this","getTable","id","methods","loadNode","node","resolve","isUpdateClickInfo","_this","asyncToGenerator_default","regenerator_default","a","mark","_callee","firstData","childData","wrap","_context","prev","next","level","getTree","sent","t0","find","v","abrupt","t1","console","log","stop","append","_this2","_callee2","_context2","forEach","$refs","bigTree","expanded","showTable","arr","del","first","_this3","Object","request","actionType","then","res","reload","promise_default","reject","items","catch","err","_this4","extends_default","query","total","editParent","createDialog","editChildren","row","isTrue","closeDialog","createAssets","_this5","validate","valid","code","$message","error","msg","success","childNodes","parent","center","type","created","updated","_this6","$nextTick","window","innerHeight","positionRef","$el","offsetTop","position_positionList","render","_vm","_h","$createElement","_c","_self","_m","_v","staticClass","attrs","on","click","$event","style","overflow","height","ref","highlight-current","lazy","load","props","node-click","scopedSlots","_u","key","fn","title","_s","staticStyle","border-bottom","padding-bottom","disabled","deep","_e","border","tooltip-effect","max-height","prop","width","align","fixed","scope","size","close-on-click-modal","visible","destroy-on-close","update:visible","close","model","label-width","maxlength","value","callback","$$v","$set","expression","trim","slot","staticRenderFns","margin-bottom","font-size","font-weight","color","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/10.b1f6d1264a9c9e87a924.js","sourcesContent":["<template>\r\n  <div>\r\n    <div style=\"height:50px;border-bottom:1px solid #DFDCDC;margin-bottom:10px;\">\r\n      <span style=\"font-size:24px;font-weight:bold;color:#614a4d;\">位置设置</span>\r\n    </div>\r\n    <el-container>\r\n      <div class=\"asideTree\">\r\n        <el-button type=\"primary\" @click=\"createDialog(true)\">添加一级位置</el-button>\r\n        <div :style=\"{'overflow':'auto','height':treeHeight+'px'}\">\r\n          <el-tree ref=\"bigTree\" highlight-current lazy :load=\"loadNode\" @node-click=\"showTable\" :props=\"defaultProps\">\r\n            <span class=\"span-ellipsis\" slot-scope=\"{ node }\">\r\n              <span :title=\"node.label\">{{ node.label }}</span>\r\n            </span>\r\n          </el-tree>\r\n        </div>\r\n      </div>\r\n      <el-main>\r\n        <div>\r\n          <el-row class=\"tac\" style=\"border-bottom:1px solid #eeeeee; padding-bottom:15px;\">\r\n            <el-button v-if=\"clickInfo\" :disabled=\"clickInfo.deep==2\" type=\"primary\" @click=\"createDialog(false)\">新增</el-button>\r\n            <el-button v-if=\"clickInfo\" type=\"primary\" @click=\"editParent\">编辑</el-button>\r\n            <el-button v-if=\"clickInfo\" :disabled=\"!!clickInfo.parentId\" type=\"danger\" @click=\"del(clickInfo.id,true)\">删除一级位置</el-button>\r\n          </el-row>\r\n        </div>\r\n        <div>\r\n          <el-table ref=\"positionRef\" :data=\"positionTable\" border tooltip-effect=\"dark\" :max-height=\"tableHeight\">\r\n            <el-table-column prop=\"id\" label=\"ID\" width=\"50\" align=\"center\"></el-table-column>\r\n            <el-table-column label=\"位置名称\" prop=\"parentPositionName\" align=\"center\"></el-table-column>\r\n            <el-table-column label=\"子级位置名称名称\" prop=\"positionName\" align=\"center\"></el-table-column>\r\n            <el-table-column fixed=\"right\" label=\"操作\" width=\"200\" align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <el-button type=\"primary\" size=\"mini\" @click=\"editChildren(scope.row)\">编辑</el-button>\r\n                <el-button type=\"danger\" size=\"mini\" @click=\"del(scope.row.id,false)\">删除</el-button>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </div>\r\n        <div>\r\n          <pagination :totalNum=\"totalNum\"></pagination>\r\n        </div>\r\n        <el-dialog :title=\"(isEdit?'编辑':'添加')+(firstLevel?'一级位置':'子级位置')\" :close-on-click-modal=\"false\" :visible.sync=\"showAssetsDialog\" destroy-on-close @close=\"closeDialog\" width=\"450px\" center>\r\n          <el-form ref=\"form\" :model=\"form\" label-width=\"150px\" :rules=\"rules\">\r\n            <el-form-item v-if=\"!firstLevel\" label=\"上级位置名称\" required>\r\n              <el-input disabled v-model=\"form.parentPositionName\" style=\"width:200px;\" maxlength=\"20\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item :label=\"firstLevel?'一级位置名称':'子级位置名称'\" prop=\"positionName\" required>\r\n              <el-input v-model.trim=\"form.positionName\" style=\"width:200px;\" maxlength=\"20\"></el-input>\r\n            </el-form-item>\r\n          </el-form>\r\n          <span slot=\"footer\" class=\"dialog-footer\">\r\n            <el-button :disabled=\"isConfirm\" type=\"primary\" @click=\"createAssets\">{{isConfirm?isEdit?'修改中...':'创建中...':'确 定'}}</el-button>\r\n            <el-button @click=\"showAssetsDialog=false\">取消</el-button>\r\n          </span>\r\n        </el-dialog>\r\n      </el-main>\r\n    </el-container>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport pagination from '../../share/pagination'\r\nimport {getPositionTree,getPositionList,createPosition,editPosition,delPosition} from '../../http/request'\r\nexport default {\r\n  name:'positionList',\r\n  inject:['reload'],\r\n  components:{\r\n    pagination\r\n  },\r\n  data(){\r\n    return{\r\n      isConfirm:false,\r\n      isEdit:false,\r\n      treedata:[],//树形列表\r\n      defaultProps:{label: 'positionName',isLeaf:'leaf'},\r\n      positionTable:[],//资产位置列表\r\n      showAssetsDialog:false,//显示创建资产弹窗\r\n      firstLevel:false,//是否创建一级位置\r\n      clickInfo:'',//点击的树节点数据\r\n      clickNode:null,//当前点击节点\r\n      editId:'',\r\n      form:{\r\n        positionName:'',\r\n        parentPositionName:'',\r\n        parentId:''\r\n      },\r\n      rules:{\r\n        positionName:[{required: true, message: '请输入位置名称', trigger: 'change'},{required: true, message: '请输入位置名称', trigger: 'blur'}],\r\n      },\r\n      tableHeight:500,\r\n      treeHeight:500,\r\n      totalNum:0,\r\n      myNode0:null,\r\n      myResolve0:null,\r\n      nodeObject:{},\r\n      isEditRow:false\r\n    }\r\n  },\r\n  watch:{\r\n    $route(){\r\n      this.clickInfo?this.getTable(this.clickInfo.id):null;\r\n    }\r\n  },\r\n  methods:{\r\n    async loadNode(node, resolve,isUpdateClickInfo) {\r\n      if (node.level === 0) {\r\n        this.myNode0 = node;\r\n        this.myResolve0 = resolve;\r\n        let firstData;\r\n        try{\r\n          firstData = await this.getTree(0);\r\n        }catch(err){\r\n          firstData = err;\r\n        }\r\n        if(isUpdateClickInfo){\r\n          this.clickInfo=firstData.find(v=>v.id===this.clickInfo.id);\r\n        }\r\n        return resolve(firstData);    \r\n      }\r\n      this.nodeObject[node.data.id+'']={node,resolve};\r\n      if (node.level > 3) return resolve([]);\r\n      let childData;\r\n      try{\r\n        childData = await this.getTree(node.data.id);\r\n      }catch(err){\r\n        childData = err;\r\n      }\r\n      console.log(childData,1515)\r\n      resolve(childData)  \r\n    },\r\n    async append(node,isUpdateClickInfo){\r\n      let childData;\r\n      try{\r\n        childData = await this.getTree(node.data.id);\r\n      }catch(err){\r\n        childData = err;\r\n      }\r\n      if(isUpdateClickInfo){\r\n        this.clickInfo=childData.find(v=>v.id===this.clickInfo.id);\r\n      }\r\n      childData.forEach(v=>{\r\n        this.$refs.bigTree.append(v,node);\r\n      })\r\n      node.expanded=true;\r\n    },\r\n    showTable(arr,node){\r\n      this.clickNode = node;\r\n      this.clickInfo = arr;\r\n      this.getTable(arr.id);\r\n    },\r\n    del(id,first){\r\n      if(first){\r\n        delPosition({id,\"actionType\":3}).then(res=>{\r\n          this.reload();\r\n        })\r\n      }else{\r\n        delPosition({id,\"actionType\":3}).then(res=>{\r\n          this.loadNode(this.nodeObject[this.clickInfo.id+''].node,this.nodeObject[this.clickInfo.id+''].resolve);\r\n          this.getTable(this.clickInfo.id);\r\n        })\r\n      }\r\n    },\r\n    getTree(parentId){//查询位置树状结构\r\n      return new Promise((resolve,reject)=>{\r\n        getPositionTree({parentId}).then(res=>{\r\n          // this.treedata = res.data.items;\r\n          let treedata = res.data.items\r\n          // .map(v=>{if(v.deep==2){v.leaf=true};return v;});\r\n          resolve(treedata);\r\n        }).catch(err=>{\r\n          reject([])\r\n        })\r\n      })\r\n    },\r\n    getTable(parentId){\r\n      getPositionList({parentId,...this.$route.query}).then(res=>{\r\n        this.positionTable = res.data.items;\r\n        this.totalNum = res.data.total;\r\n      });    \r\n    },\r\n    editParent(){\r\n      this.isEditRow = false;\r\n      this.isEdit=true;\r\n      this.editId = this.clickInfo.id;\r\n      this.clickInfo.parentId==0?this.createDialog(true):this.createDialog(false);  \r\n      this.form.positionName = this.clickInfo.positionName;\r\n      this.form.parentPositionName = this.clickInfo.parentPositionName;\r\n      this.form.parentId = this.clickInfo.parentId?this.clickInfo.parentId:'';\r\n    },\r\n    editChildren(row){\r\n      this.isEditRow = true;\r\n      this.isEdit=true;\r\n      this.editId = row.id;\r\n      this.createDialog(false);\r\n      this.form.positionName = row.positionName;\r\n      this.form.parentPositionName = row.parentPositionName;\r\n      this.form.parentId = row.parentId?row.parentId:'';\r\n    },\r\n    createDialog(isTrue){//创建窗口\r\n      this.showAssetsDialog=true;\r\n      this.firstLevel = isTrue;\r\n      if(!isTrue){\r\n        this.form.parentPositionName = this.clickInfo.positionName;\r\n        this.form.parentId = this.clickInfo.id;\r\n      }\r\n    },\r\n    closeDialog(){\r\n      this.showAssetsDialog=false;\r\n      this.isEdit=false;\r\n      this.editId='';\r\n      this.form.positionName = '';\r\n      this.form.parentPositionName = '';\r\n      this.form.parentId = '';\r\n    },\r\n    createAssets(){\r\n      this.$refs.form.validate((valid) => {\r\n        if (valid) {\r\n          this.isConfirm=true;\r\n          if(this.isEdit){\r\n            editPosition({\"id\":this.editId,\"positionName\":this.form.positionName,\"parentId\":this.firstLevel?this.clickInfo.parentId:this.form.parentId}).then(res=>{\r\n              this.isConfirm = false;\r\n              if(res.code){\r\n                this.$message.error(res.msg);\r\n              }else{\r\n                this.$message.success(res.msg);\r\n                           \r\n                if(this.isEditRow){\r\n                  this.clickNode.childNodes = [];\r\n                  this.append(this.clickNode);\r\n                }else{\r\n                  this.clickNode.parent.childNodes=[];\r\n                  if(this.clickNode.level===1){\r\n                    this.loadNode(this.myNode0,this.myResolve0,true)\r\n                  }else{\r\n                    this.append(this.clickNode.parent,true);\r\n                  }\r\n                }\r\n                this.getTable(this.clickInfo.id); \r\n                this.closeDialog();\r\n                this.isEdit=false;\r\n              }\r\n            }).catch(err=>{\r\n              this.isConfirm = false;\r\n            })\r\n          }else{\r\n            createPosition({\"positionName\":this.form.positionName,\"parentId\":this.firstLevel?this.clickInfo.parentId:this.form.parentId}).then(res=>{\r\n              this.isConfirm = false;\r\n              if(res.code){\r\n                this.$message.error(res.msg);\r\n              }else{\r\n                this.$message({\r\n                  message: res.msg,\r\n                  center: true,\r\n                  type: 'success'\r\n                })\r\n                if(this.firstLevel){\r\n                  this.myNode0.childNodes = [];\r\n                  this.loadNode(this.myNode0,this.myResolve0);\r\n                }else{\r\n                  if(this.clickInfo){\r\n                    this.nodeObject[this.clickInfo.id+''].node.childNodes = [];\r\n                  }\r\n                  this.loadNode(this.nodeObject[this.clickInfo.id+''].node,this.nodeObject[this.clickInfo.id+''].resolve);\r\n                  this.getTable(this.clickInfo.id);\r\n                }          \r\n                this.closeDialog();\r\n              }\r\n            }).catch(err=>{\r\n              this.isConfirm = false;\r\n            });\r\n          }           \r\n        } else {\r\n          console.log('error submit!!');\r\n          return false;\r\n        }\r\n      });   \r\n    },\r\n  },\r\n  created(){\r\n    // this.getTree();//获取外边的树\r\n  },\r\n  updated(){\r\n    this.$nextTick(()=>{\r\n      this.tableHeight = window.innerHeight - this.$refs.positionRef.$el.offsetTop - 110;\r\n      this.treeHeight = window.innerHeight - this.$refs.bigTree.$el.offsetTop - 110;\r\n      console.log(this.tableHeight)\r\n    })\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.asideTree {\r\n  width: 25%;\r\n  height: 100%;\r\n}\r\n.span-ellipsis {\r\n  width: 100%;\r\n  overflow: hidden;\r\n  white-space: nowrap;\r\n  text-overflow: ellipsis;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/position/positionList.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_vm._m(0),_vm._v(\" \"),_c('el-container',[_c('div',{staticClass:\"asideTree\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.createDialog(true)}}},[_vm._v(\"添加一级位置\")]),_vm._v(\" \"),_c('div',{style:({'overflow':'auto','height':_vm.treeHeight+'px'})},[_c('el-tree',{ref:\"bigTree\",attrs:{\"highlight-current\":\"\",\"lazy\":\"\",\"load\":_vm.loadNode,\"props\":_vm.defaultProps},on:{\"node-click\":_vm.showTable},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar node = ref.node;\nreturn _c('span',{staticClass:\"span-ellipsis\"},[_c('span',{attrs:{\"title\":node.label}},[_vm._v(_vm._s(node.label))])])}}])})],1)],1),_vm._v(\" \"),_c('el-main',[_c('div',[_c('el-row',{staticClass:\"tac\",staticStyle:{\"border-bottom\":\"1px solid #eeeeee\",\"padding-bottom\":\"15px\"}},[(_vm.clickInfo)?_c('el-button',{attrs:{\"disabled\":_vm.clickInfo.deep==2,\"type\":\"primary\"},on:{\"click\":function($event){return _vm.createDialog(false)}}},[_vm._v(\"新增\")]):_vm._e(),_vm._v(\" \"),(_vm.clickInfo)?_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.editParent}},[_vm._v(\"编辑\")]):_vm._e(),_vm._v(\" \"),(_vm.clickInfo)?_c('el-button',{attrs:{\"disabled\":!!_vm.clickInfo.parentId,\"type\":\"danger\"},on:{\"click\":function($event){return _vm.del(_vm.clickInfo.id,true)}}},[_vm._v(\"删除一级位置\")]):_vm._e()],1)],1),_vm._v(\" \"),_c('div',[_c('el-table',{ref:\"positionRef\",attrs:{\"data\":_vm.positionTable,\"border\":\"\",\"tooltip-effect\":\"dark\",\"max-height\":_vm.tableHeight}},[_c('el-table-column',{attrs:{\"prop\":\"id\",\"label\":\"ID\",\"width\":\"50\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"位置名称\",\"prop\":\"parentPositionName\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"子级位置名称名称\",\"prop\":\"positionName\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"fixed\":\"right\",\"label\":\"操作\",\"width\":\"200\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.editChildren(scope.row)}}},[_vm._v(\"编辑\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"danger\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.del(scope.row.id,false)}}},[_vm._v(\"删除\")])]}}])})],1)],1),_vm._v(\" \"),_c('div',[_c('pagination',{attrs:{\"totalNum\":_vm.totalNum}})],1),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":(_vm.isEdit?'编辑':'添加')+(_vm.firstLevel?'一级位置':'子级位置'),\"close-on-click-modal\":false,\"visible\":_vm.showAssetsDialog,\"destroy-on-close\":\"\",\"width\":\"450px\",\"center\":\"\"},on:{\"update:visible\":function($event){_vm.showAssetsDialog=$event},\"close\":_vm.closeDialog}},[_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.form,\"label-width\":\"150px\",\"rules\":_vm.rules}},[(!_vm.firstLevel)?_c('el-form-item',{attrs:{\"label\":\"上级位置名称\",\"required\":\"\"}},[_c('el-input',{staticStyle:{\"width\":\"200px\"},attrs:{\"disabled\":\"\",\"maxlength\":\"20\"},model:{value:(_vm.form.parentPositionName),callback:function ($$v) {_vm.$set(_vm.form, \"parentPositionName\", $$v)},expression:\"form.parentPositionName\"}})],1):_vm._e(),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":_vm.firstLevel?'一级位置名称':'子级位置名称',\"prop\":\"positionName\",\"required\":\"\"}},[_c('el-input',{staticStyle:{\"width\":\"200px\"},attrs:{\"maxlength\":\"20\"},model:{value:(_vm.form.positionName),callback:function ($$v) {_vm.$set(_vm.form, \"positionName\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"form.positionName\"}})],1)],1),_vm._v(\" \"),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"disabled\":_vm.isConfirm,\"type\":\"primary\"},on:{\"click\":_vm.createAssets}},[_vm._v(_vm._s(_vm.isConfirm?_vm.isEdit?'修改中...':'创建中...':'确 定'))]),_vm._v(\" \"),_c('el-button',{on:{\"click\":function($event){_vm.showAssetsDialog=false}}},[_vm._v(\"取消\")])],1)],1)],1)],1)],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"height\":\"50px\",\"border-bottom\":\"1px solid #DFDCDC\",\"margin-bottom\":\"10px\"}},[_c('span',{staticStyle:{\"font-size\":\"24px\",\"font-weight\":\"bold\",\"color\":\"#614a4d\"}},[_vm._v(\"位置设置\")])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-01e209c6\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/position/positionList.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-01e209c6\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./positionList.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./positionList.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./positionList.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-01e209c6\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./positionList.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-01e209c6\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/position/positionList.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}