webpackJsonp([3],{"80Bn":function(e,t){},C3fW:function(e,t){},Tsx8:function(e,t){},mcnL:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("y1lO"),n={props:["fSee","id"],name:"equipmentList",inject:["replace","reload"],data:function(){return{dialogVisible:!1,gridData:[],ids:""}},computed:{},watch:{fSee:function(){this.fSee&&this.id&&this.listData(),this.dialogVisible=this.fSee}},methods:{handleClose:function(){},listData:function(){var e=this;Object(a.o)({deviceId:this.id}).then(function(t){e.gridData=t.data||[]})},close:function(){this.dialogVisible=!1,this.$emit("dialogDelClose")},del:function(){var e=this;Object(a.m)({deviceId:this.id}).then(function(t){t.code?e.$message.error(t.msg):e.reload()})}},created:function(){},updated:function(){},components:{}},l={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{title:"删除设备",visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t},closed:e.close}},[i("h3",[e._v("删除设备，需先解绑设备所在直播间的机位，此设备绑定的机位如下：")]),e._v(" "),i("el-table",{staticClass:"mt15 mb15",staticStyle:{width:"100%"},attrs:{data:e.gridData,border:""}},[i("el-table-column",{attrs:{property:"liveName",label:"直播间名称",width:"150",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{property:"deviceName",label:"设备名称",width:"200",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{property:"cameraName",label:"机位名称",align:"center"}})],1),e._v(" "),i("div",{staticStyle:{width:"250px",margin:"0px auto","margin-top":"40px"}})],1)],1)},staticRenderFns:[]};var o=i("VU/8")(n,l,!1,function(e){i("C3fW")},"data-v-68ba3f42",null).exports,s=i("Dd8w"),r=i.n(s),d=i("//Fk"),c=i.n(d),u=i("Xxa5"),m=i.n(u),f=i("exGp"),h=i.n(f),p={props:["fSee","id"],name:"equipmentList",inject:["replace","reload"],data:function(){return{dialogVisible:!1,isCreate:!0,formSize:{name:"",serverId:"",positionId:"",resolvingId:""},tagShow:!1,dynamicTags:[],serverList:[{id:1,name:1}],address:"自动生成",listResolving:[{id:1,name:1}],checkId:!1,innerVisible:!1,btnShow:!0,title:"",titleDig:"创建设备",rules:{name:[{required:!0,message:"请输入设备名称",trigger:"change"},{min:1,max:28,message:"长度在 1 到 20 个字符",trigger:"change"}],serverId:[{required:!0,message:"请选择服务器",trigger:"change"}],resolvingId:[{required:!0,message:"请选择分辨率",trigger:"change"}]},treedata:[],defaultProps:{label:"positionName",isLeaf:"leaf"},positionTable:[],mySetTimeout:null,disable:!1}},computed:{},watch:{fSee:function(){this.fSee&&this.id&&this.infoData(),this.dialogVisible=this.fSee}},methods:{loadNode:function(e,t,i){var a=this;return h()(m.a.mark(function n(){var l,o;return m.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a.myNode=e,a.myResolve=t,0!==e.level){n.next=17;break}return a.myNode0=e,a.myResolve0=t,l=void 0,n.prev=6,n.next=9,a.getTree(0);case 9:l=n.sent,n.next=15;break;case 12:n.prev=12,n.t0=n.catch(6),l=n.t0;case 15:return i&&(a.clickInfo=l.find(function(e){return e.id===a.clickInfo.id})),n.abrupt("return",t(l));case 17:if(!(e.level>3)){n.next=19;break}return n.abrupt("return",t([]));case 19:return o=void 0,n.prev=20,n.next=23,a.getTree(e.data.id);case 23:o=n.sent,n.next=29;break;case 26:n.prev=26,n.t1=n.catch(20),o=n.t1;case 29:t(o);case 30:case"end":return n.stop()}},n,a,[[6,12],[20,26]])}))()},showTable:function(e,t){this.clickNode=t,this.clickInfo=e,this.getTable(e.id)},getTree:function(e){return new c.a(function(t,i){Object(a.E)({parentId:e}).then(function(e){var i=e.data.items;t(i)}).catch(function(e){i([])})})},getTable:function(e){var t=this;Object(a.D)(r()({parentId:e},this.$route.query)).then(function(e){t.positionTable=e.data.items,t.totalNum=e.data.total})},listData:function(){var e=this;queryDeviceManageList(this.$route.query).then(function(t){e.gridData=t.data.items})},dropServerData:function(){var e=this;Object(a.W)({}).then(function(t){e.serverList=t.data})},dropListResolvingData:function(){var e=this;Object(a.H)({status:1}).then(function(t){e.listResolving=t.data.items})},close:function(){this.dialogVisible=!1,this.dynamicTags=[],this.isCreate=!0,this.tagShow=!1,this.btnShow=!0,this.reload(),this.$emit("dialogEditClose")},innerClose:function(){this.innerVisible=!1},selectOne:function(e){this.checkId=!0,this.tagShow=!0,this.dynamicTags.length?this.dynamicTags.push(r()({},e)).unshift():this.dynamicTags.push(r()({},e)),this.innerVisible=!1,this.btnShow=!1,this.formSize.positionId=e.id},infoData:function(){var e=this;this.titleDig="编辑设备",Object(a.o)({deviceId:this.id}).then(function(t){t.data.length?e.disable=!0:e.disable=!1}),Object(a.M)({id:this.id}).then(function(t){t.code?e.$message.error(t.msg):(t.data.detailPositionName?(e.isCreate=!1,e.btnShow=!1):(e.isCreate=!0,e.btnShow=!0),e.formSize=t.data,e.dynamicTags=[],t.data.positionId&&e.dynamicTags.push(r()({},e.formSize)))})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;Object(a.L)(r()({},t.formSize)).then(function(e){e.code?t.$message.error(e.msg):t.reload()})})},handleClose:function(e){console.log(e,1111),this.formSize.positionId="",this.dynamicTags.splice(this.dynamicTags.indexOf(e),1),this.btnShow=!0,this.checkId=!1}},created:function(){this.dropServerData(),this.dropListResolvingData()},updated:function(){},destroyed:function(){clearTimeout(this.mySetTimeout)},components:{}},b={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{title:e.titleDig,visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t},closed:e.close}},[i("el-form",{ref:"formSize",attrs:{model:e.formSize,"label-width":"110px",rules:e.rules}},[i("el-form-item",{attrs:{label:"设备名称：",prop:"name"}},[i("el-input",{attrs:{maxlength:"20"},model:{value:e.formSize.name,callback:function(t){e.$set(e.formSize,"name","string"==typeof t?t.trim():t)},expression:"formSize.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"推流地址："}},[i("el-input",{attrs:{disabled:!0},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"服务器：",prop:"serverId"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{disabled:e.disable},model:{value:e.formSize.serverId,callback:function(t){e.$set(e.formSize,"serverId",t)},expression:"formSize.serverId"}},e._l(e.serverList,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"分辨率：",prop:"resolvingId"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{disabled:e.disable},model:{value:e.formSize.resolvingId,callback:function(t){e.$set(e.formSize,"resolvingId",t)},expression:"formSize.resolvingId"}},e._l(e.listResolving,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"投放位置："}},[!e.isCreate||e.tagShow?i("span",e._l(e.dynamicTags,function(t){return i("el-tag",{key:t.name,attrs:{closable:"","disable-transitions":!1},on:{close:function(i){return e.handleClose(t.name)}}},[e._v("\n      "+e._s(t.pathName||t.detailPositionName)+"\n    ")])}),1):e._e(),e._v(" "),e.btnShow?i("el-button",{on:{click:function(t){e.innerVisible=!0}}},[e._v("选择位置")]):e._e()],1)],1),e._v(" "),i("div",{staticStyle:{width:"180px",margin:"0px auto","margin-top":"40px"}},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("formSize")}}},[e._v("确认")]),e._v(" "),i("el-button",{on:{click:e.close}},[e._v("取 消")])],1),e._v(" "),i("el-dialog",{attrs:{width:"70%",title:"位置",visible:e.innerVisible,"append-to-body":""},on:{"update:visible":function(t){e.innerVisible=t},closed:e.innerClose}},[i("el-row",[i("el-col",{attrs:{span:6}},[i("el-tree",{ref:"bigTree",attrs:{lazy:"","highlight-current":"",load:e.loadNode,props:e.defaultProps},on:{"node-click":e.showTable},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.node;return i("span",{staticClass:"span-ellipsis"},[i("span",{attrs:{title:a.label}},[e._v(e._s(a.label))])])}}])})],1),e._v(" "),i("el-col",{attrs:{span:18}},[i("el-table",{ref:"multipleTable",staticClass:"mt15 mb15 el-table",staticStyle:{width:"100%"},attrs:{data:e.positionTable,border:""}},[i("el-table-column",{attrs:{prop:"id",label:"ID",width:"100",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"parentPositionName",label:"位置名称",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"positionName",label:"子级位置名称",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",width:"120 ",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(i){return e.selectOne(t.row)}}},[e._v("选择")])]}}])})],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var v={name:"equipmentList",inject:["replace","reload"],data:function(){return{dialogDelShow:!1,dialogEditShow:!1,wd:"",q:"",tableData:[],status:"",serverStatus:"",serverList:[],GroupStatus:"",liveStatus:"",total:0,id:0}},computed:{},watch:{$route:function(){"equipmentList"==this.$route.name&&this.listData()}},methods:{listData:function(){var e=this;Object(a.N)(this.$route.query).then(function(t){e.tableData=t.data.items,e.total=t.data.total})},upState:function(e,t){},del:function(e){var t=this;Object(a.o)({deviceId:e}).then(function(i){i.data.length?t.dialogDelShow=!0:Object(a.m)({deviceId:e}).then(function(e){e.code?t.$message.error(e.msg):t.reload()})}),this.id=e},dialogDelClose:function(){this.dialogDelShow=!1},dialogEditClose:function(){this.dialogEditShow=!1},edit:function(e){this.dialogEditShow=!0,this.id=e}},created:function(){this.listData()},updated:function(){this.$route.name},components:{dialogDel:o,dialogEdit:i("VU/8")(p,b,!1,function(e){i("Tsx8")},"data-v-ce018456",null).exports}},g={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",["equipmentList"==e.$route.name?i("div",[i("div",{staticStyle:{height:"50px","border-bottom":"1px solid #DFDCDC"}},[i("span",{staticStyle:{"font-size":"24px","font-weight":"bold",color:"#614a4d"}},[e._v("设备管理")]),e._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(t){return e.edit()}}},[e._v("添加设备")])],1),e._v(" "),i("el-table",{ref:"multipleTable",staticClass:"mt15 mb15 el-table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[i("el-table-column",{attrs:{prop:"id",label:"ID",width:"80",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"name",label:"设备名称",width:"180",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"resolvingName",label:"分辨率",align:"center",width:"120"}}),e._v(" "),i("el-table-column",{attrs:{prop:"relativePath",label:"直播推流地址",width:"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          rtmp://"+e._s(t.row.address)+":"+e._s(t.row.pushPort)+e._s(t.row.relativePath)+"\n        ")]}}],null,!1,141757829)}),e._v(" "),i("el-table-column",{attrs:{prop:"serverName",label:"服务器",width:"150",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"address",label:"服务器IP",width:"150",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"detailPositionName",label:"投放位置",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.detailPositionName?t.row.detailPositionName:"--")+"\n        ")]}}],null,!1,3487588472)}),e._v(" "),i("el-table-column",{attrs:{prop:"onlineStatus",label:"在线状态",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.onlineStatus?i("span",{staticStyle:{color:"#339900"}},[e._v("在线")]):e._e(),e._v(" "),2==t.row.onlineStatus?i("span",{staticStyle:{color:"red"}},[e._v("离线")]):e._e()]}}],null,!1,4266635344)}),e._v(" "),i("el-table-column",{attrs:{prop:"status",label:"启用状态",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?i("span",{staticStyle:{color:"#339900"}},[e._v("启用")]):e._e(),e._v(" "),2==t.row.status?i("span",{staticStyle:{color:"red"}},[e._v("停用")]):e._e(),e._v(" "),3==t.row.status?i("span",{staticStyle:{color:"red"}},[e._v("删除")]):e._e()]}}],null,!1,1878057146)}),e._v(" "),i("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"180",align:"center"}}),e._v(" "),i("el-table-column",{key:"3",attrs:{label:"操作",fixed:"right",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){return e.edit(t.row.id)}}},[e._v("编辑")]),e._v(" "),i("el-button",{attrs:{type:"danger",size:"mini",disabled:1==t.row.liveState||2==t.row.liveState},on:{click:function(i){return e.del(t.row.id)}}},[e._v("删除")])]}}],null,!1,1491523184)})],1),e._v(" "),i("dialogDel",{attrs:{fSee:e.dialogDelShow,id:e.id},on:{dialogDelClose:e.dialogDelClose}}),e._v(" "),i("dialogEdit",{attrs:{fSee:e.dialogEditShow,id:e.id},on:{dialogEditClose:e.dialogEditClose}})],1):e._e()])},staticRenderFns:[]};var _=i("VU/8")(v,g,!1,function(e){i("80Bn")},"data-v-932f8df0",null);t.default=_.exports}});
//# sourceMappingURL=3.359069e2370ad883557b.js.map